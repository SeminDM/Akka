@{
    ViewData["Title"] = "DeliverAsync";
}

<body>
    <h2>Put goods</h2>
    <form action="/Home/DeliverAsync" method="post">


        <div class="item">
            <label>Goods</label>
            <input name="goods" value="goods" />
        </div>
        <!-- <input type="submit" value="Отправить" /> -->
        <div><button>Отправить</button></div>
    </form>

    <div id="goods"></div>

    <script src="~/js/signalr/signalr.min.js"></script>
    <script>

        let hubUrl = 'http://localhost:27961/deliver';
        const hubConnection = new signalR.HubConnectionBuilder()
            .withUrl(hubUrl)
            .configureLogging(signalR.LogLevel.Information)
            .build();

        hubConnection.start().then(function () {

            hubConnection.invoke("SendMessageAsync", "Connected");

        });

        hubConnection.on("SendMessage", function (data) {

            let elem = document.createElement("p");
            elem.appendChild(document.createTextNode(data));
            let firstElem = document.getElementById("goods").firstChild;
            document.getElementById("goods").insertBefore(elem, firstElem);

        });

        hubConnection.start();
    </script>
</body>